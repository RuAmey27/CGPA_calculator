<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>CGPA Calculator</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#semester').change(function() {
                var departmentId = $('#department').val();
                var semesterId = $(this).val();
                if (departmentId && semesterId) {
                    $.get('/cgpa/subjects', {departmentId: departmentId, semesterId: semesterId}, function(data) {
                        var subjectsDiv = $('#subjects');
                        subjectsDiv.empty();
                        $.each(data, function(index, subject) {
                            subjectsDiv.append('<div>' + subject.name + ' (' + subject.credits + ' credits): <input type="text" name="grade_' + subject.id + '"></div>');
                        });
                    });
                }
            });
        });
    </script>
</head>
<body>
<h1>CGPA Calculator</h1>

<form action="/cgpa/calculate" method="post">
    <label for="department">Select Department:</label>
    <select id="department" name="departmentId">
        <option th:each="department : ${departments}" th:value="${department.id}" th:text="${department.name}"></option>
    </select>

    <label for="semester">Select Semester:</label>
    <select id="semester" name="semesterId">
        <option th:each="semester : ${semesters}" th:value="${semester.id}" th:text="${semester.name}"></option>
    </select>

    <div id="subjects">
        <!-- Subjects will be dynamically loaded here -->
    </div>

    <button type="submit">Calculate CGPA</button>
</form>
</body>
</html>
